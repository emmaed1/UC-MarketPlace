datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id               Int       @id @default(autoincrement())
  name             String?   @db.VarChar(255)
  email            String    @unique @db.VarChar(255)
  password         String
  profile          Profile?
  sentMessages     Message[] @relation("SentMessages")
  receivedMessages Message[] @relation("ReceivedMessages")
  products         Product[] @relation("UserProducts")
}

model Profile {
  id     Int     @id @default(autoincrement())
  bio    String?
  userId Int     @unique
  user   User    @relation(fields: [userId], references: [id])
}

model Product {
  productId Int      @id @default(autoincrement())
  name      String   @db.VarChar(255)
  desc      String
  price     Float
  quantity  Int
  rating    Float?
  img       String?
  sellerId  Int
  seller    User     @relation(fields: [sellerId], references: [id], name: "UserProducts")
  messages  Message[]
}

model Message {
  id          Int      @id @default(autoincrement())
  senderId    Int
  receiverId  Int
  productId   Int
  content     String
  timestamp   DateTime @default(now())
  isRead      Boolean  @default(false)

  sender      User     @relation("SentMessages", fields: [senderId], references: [id])
  receiver    User     @relation("ReceivedMessages", fields: [receiverId], references: [id])
  product     Product  @relation(fields: [productId], references: [productId])
}